<!doctype html><html lang=en-us><head><title>Switching to Netlify for static hosting // Alex Norell</title>
<link rel="shortcut icon" href=images/favicon/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.122.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Alex Norell"><meta name=description content><link rel=stylesheet href=/css/main.min.f8363c507f66dee0a21930377ce8785fd9f57b9a652078043ab8dd988bc0d4f4.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Switching to Netlify for static hosting"><meta name=twitter:description content="Previously I had my website hosted in a GCP instance behind nginx. That really was too much overhead for what I actually needed for this site.
A couple of the downsides:
Manual setup of the entire GCP instance No CI pipeline No CDN Expensive Manual Set Up I go over in my previous post, Creating and Deploying This Website. In summary, I was previously using the free tier of GCP to host a nano sized instance that contained nGINX and several static websites."><meta property="og:title" content="Switching to Netlify for static hosting"><meta property="og:description" content="Previously I had my website hosted in a GCP instance behind nginx. That really was too much overhead for what I actually needed for this site.
A couple of the downsides:
Manual setup of the entire GCP instance No CI pipeline No CDN Expensive Manual Set Up I go over in my previous post, Creating and Deploying This Website. In summary, I was previously using the free tier of GCP to host a nano sized instance that contained nGINX and several static websites."><meta property="og:type" content="article"><meta property="og:url" content="https://alexnorell.com/post/switching-to-netlify/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-08-16T12:59:51-07:00"><meta property="article:modified_time" content="2020-08-16T12:59:51-07:00"></head><body><header class=app-header><a href=https://alexnorell.com/><img class=app-header-avatar src=/images/avatar.jpg alt="Alex Norell"></a>
<span class=app-header-title>Alex Norell</span><nav class=app-header-menu><a class=app-header-menu-item href=/>Home</a>
-
<a class=app-header-menu-item href=/categories/>Categories</a>
-
<a class=app-header-menu-item href=/tags/>Tags</a></nav><p>Software Engineer with a passion for IoT</p><div class=app-header-social><a href=https://github.com/alexnorell target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=https://linkedin.com/in/alexnorell target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin"><title>linkedin</title><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href=https://youtube.com/alexnorell target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-youtube"><title>youtube</title><path d="M22.54 6.42a2.78 2.78.0 00-1.94-2C18.88 4 12 4 12 4s-6.88.0-8.6.46a2.78 2.78.0 00-1.94 2A29 29 0 001 11.75a29 29 0 00.46 5.33A2.78 2.78.0 003.4 19c1.72.46 8.6.46 8.6.46s6.88.0 8.6-.46a2.78 2.78.0 001.94-2 29 29 0 00.46-5.25 29 29 0 00-.46-5.33z"/><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Switching to Netlify for static hosting</h1><div class=post-meta><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg> 
Aug 16, 2020</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg> 
3 min read</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-folder"><title>folder</title><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg> 
<a class=tag href=https://alexnorell.com/categories/web/>web</a></div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg> 
<a class=tag href=https://alexnorell.com/tags/hugo/>hugo</a>
<a class=tag href=https://alexnorell.com/tags/netlify/>netlify</a></div></div></header><div class=post-content><p>Previously I had my website hosted in a GCP instance behind nginx. That really was too much overhead for what I actually needed for this site.</p><p>A couple of the downsides:</p><ol><li>Manual setup of the entire GCP instance</li><li>No CI pipeline</li><li>No CDN</li><li>Expensive</li></ol><h1 id=manual-set-up>Manual Set Up</h1><p>I go over in my previous post, <a href=../creating-and-deploying-this-website>Creating and Deploying This Website</a>. In summary, I was previously using the free tier of GCP to host a nano sized instance that contained nGINX and several static websites. I needed to set up certbot manually for each of these websites. I also needed to set up users and SSH credentials to lock down the machine.</p><p>Other aspects of the server that need to be taken care of on a continual basis:</p><ol><li>Security Updates</li><li>Software Updates</li><li>Users</li></ol><p>Just a ton a manual set up.</p><h1 id=no-ci-pipeline>No CI pipeline</h1><p>I didn&rsquo;t have a pipeline set up for my personal website. It would have been easy enough to do with a GitHub action. Build with Hugo and then rsync the content to the appropriate directory in the server. I have actually set it up for a different website that I hosted on the instance.</p><h2 id=github-action-used-to-deploy>GitHub action used to deploy</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ff79c6>name</span>: Deploy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>branches</span>:
</span></span><span style=display:flex><span>      - master
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>Deploy</span>:
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>runs-on</span>: ubuntu-latest
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>steps</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>uses</span>: actions/checkout@v2
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>name</span>: Checkout submodules
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>shell</span>: bash
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>run</span>: |<span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        git config --global url.&#34;https://github.com/&#34;.insteadOf &#34;git@github.com:&#34;
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        auth_header=&#34;$(git config --local --get http.https://github.com/.extraheader)&#34;
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        git submodule sync --recursive
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        git -c &#34;http.extraheader=$auth_header&#34; -c protocol.version=2 submodule update --init --force --recursive --depth=1</span>        
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>name</span>: Setup Hugo
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>uses</span>: peaceiris/actions-hugo@v2
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>with</span>:
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>hugo-version</span>: <span style=color:#f1fa8c>&#34;latest&#34;</span>
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>name</span>: Build site
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>run</span>: hugo --minify
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>name</span>: Deploy to server
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>uses</span>: Pendect/action-rsyncer@v1.1.0
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>env</span>:
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>DEPLOY_KEY</span>: ${{secrets.DEPLOY_KEY}}
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>with</span>:
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>flags</span>: <span style=color:#f1fa8c>&#34;-avzO --no-o --no-g --delete&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>options</span>: <span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>ssh_options</span>: <span style=color:#f1fa8c>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>src</span>: <span style=color:#f1fa8c>&#34;public/&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>dest</span>: <span style=color:#f1fa8c>&#34;github@example.com:/var/www/example.com/&#34;</span>
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>name</span>: Display status from deploy
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>run</span>: echo &#34;${{ steps.deploy.outputs.status }}&#34;
</span></span></code></pre></div><p>It was easy to do, but it wasn&rsquo;t totally fool-proof. I needed to create a user an an SSH key and add the private key to GitHub as a secret.</p><h1 id=no-cdn>No CDN</h1><p>The websites that were hosted in the instance were only available if the instance was up, and only from it. If someone was trying to access it from Japan or Ukraine, they had to get the content from the instance I was running in the Google Data Center in Oregon. A content deliver network, or CDN, propagates the content of static assets across the internet to hopefully be closer to the requester, making page load times slower. It also has the added benefit of not having a single source of failure. If for some reason one of the data centers is down that is hosting the content of my website, there are other pages in the world that also have the exact same content. The CDN will automatically route the requester to the place where the data is currently available.</p><h1 id=expensive>Expensive</h1><p>For what I&rsquo;m doing with GCP, I have no reason to actually pay for it. I&rsquo;ve had virtual private servers in the past, cheap virtual machines hosted in the cloud, and also used them for web hosting. That was also terribly inefficient. Something like GitHub Pages or Netlify are completely free, and a much better service than what I could do myself. While I did learn a lot when hosting and managing the servers in the past, I don&rsquo;t see any benefit from doing so now. At >$5 a month for an instance in GCP or less if I go with something from <a href=https://lowendbox.com>lowendbox.com</a>, I would much rather host a dynamic service that I can&rsquo;t get for free from another provider.</p><h1 id=setting-it-up>Setting it up</h1><p>I followed the guide on the <a href=https://gohugo.io/hosting-and-deployment/hosting-on-netlify/>Hugo</a>. It really took less than 5 minutes to take the content from my <a href=https://github.com/alexnorell/website>website source repository</a> and get it up in the cloud, hosted by Netlify.</p></div><div class=post-footer><script src=https://utteranc.es/client.js repo=alexnorell/website issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></article><script>document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(function(e){if(e.id){var t=document.createElement("a");for(t.href="#"+e.id,t.classList.add("header-link");e.firstChild;)t.appendChild(e.firstChild);e.appendChild(t)}})})</script></main></body></html>